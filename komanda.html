<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bizi≈Ñ komanda ‚Äî Interaktiv</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <style>
    :root{
      --bg: #f4f4f8;
      --card: rgba(255,255,255,.86);
      --text: #0f172a;
      --muted: rgba(15,23,42,.72);
      --line: rgba(15,23,42,.12);
      --accent: #2f7cff;
      --accent2: #00d4ff;
      --good: #1fce8a;
      --warn: #ffcc66;
      --shadow: 0 18px 45px rgba(0,0,0,.12);
      --radius: 18px;
    }
    body.dark{
      --bg: #0b1220;
      --card: rgba(255,255,255,.08);
      --text: #eaf0ff;
      --muted: rgba(234,240,255,.75);
      --line: rgba(255,255,255,.14);
      --accent: #7c5cff;
      --accent2: #00d2ff;
      --shadow: 0 22px 60px rgba(0,0,0,.45);
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: "Segoe UI", system-ui, -apple-system, Arial, sans-serif;
      background:
        radial-gradient(900px 520px at 18% 0%, rgba(47,124,255,.18), transparent 60%),
        radial-gradient(900px 520px at 82% 10%, rgba(0,212,255,.14), transparent 60%),
        var(--bg);
      color: var(--text);
    }

    .wrap{
      max-width: 1200px;
      margin:auto;
      padding: 56px 18px 80px;
    }

    /* Header / Controls */
    .topbar{
      display:flex;
      gap:14px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
      margin-bottom: 18px;
    }
    .title{
      display:flex;
      align-items:flex-end;
      gap:12px;
      flex-wrap:wrap;
    }
    .title h1{
      margin:0;
      font-size: clamp(28px, 3vw, 40px);
      letter-spacing:.2px;
    }
    .badge{
      font-size: 13px;
      color: var(--muted);
      padding: 6px 10px;
      border: 1px solid var(--line);
      border-radius: 999px;
      backdrop-filter: blur(10px);
      background: rgba(255,255,255,.12);
    }

    .controls{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }

    .field{
      display:flex;
      align-items:center;
      gap:10px;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.10);
      backdrop-filter: blur(10px);
      min-width: 260px;
    }
    .field i{color: var(--muted)}
    .field input{
      border:none; outline:none; width:100%;
      background:transparent; color: var(--text);
      font-size: 14px;
    }

    select, .btn{
      border: 1px solid var(--line);
      background: rgba(255,255,255,.10);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 14px;
      outline: none;
      cursor:pointer;
      backdrop-filter: blur(10px);
      font-size: 14px;
    }
    .btn{
      display:flex; align-items:center; gap:10px;
      transition: transform .15s ease;
      user-select:none;
    }
    .btn:active{ transform: scale(.98); }

    /* Layout */
    .grid{
      margin-top: 24px;
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 18px;
    }

    /* Card */
    .card{
      grid-column: span 4;
      position:relative;
      border-radius: var(--radius);
      overflow:hidden;
      border: 1px solid var(--line);
      box-shadow: var(--shadow);
      background: linear-gradient(180deg, rgba(255,255,255,.18), rgba(255,255,255,.06));
      transform: translateY(14px);
      opacity: 0;
      transition: transform .5s ease, opacity .5s ease;
    }
    .card.show{ transform: translateY(0); opacity:1; }
    .card:hover{ transform: translateY(-2px); }

    .card::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(420px 220px at 20% 0%, rgba(47,124,255,.35), transparent 60%),
        radial-gradient(420px 220px at 80% 20%, rgba(0,212,255,.28), transparent 60%);
      opacity:.35;
      pointer-events:none;
    }

    .card-inner{
      position:relative;
      padding: 18px 18px 16px;
      display:flex;
      gap:14px;
      flex-direction:column;
      height:100%;
      background: rgba(255,255,255,.06);
      backdrop-filter: blur(10px);
    }

    .toprow{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:10px;
    }

    .rank{
      display:flex;
      align-items:center;
      gap:8px;
      color: var(--muted);
      font-size: 12px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.08);
      padding: 6px 10px;
      border-radius: 999px;
    }
    .rank i{ color: var(--warn); }

    .top-mentor{
      display:inline-flex;
      gap:8px;
      align-items:center;
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(31,206,138,.35);
      background: rgba(31,206,138,.12);
      color: var(--text);
      white-space:nowrap;
    }
    .top-mentor i{ color: var(--good); }

    .head{
      display:flex;
      gap:14px;
      align-items:center;
    }

    .avatar{
      width: 78px;
      height: 78px;
      border-radius: 20px;
      overflow:hidden;
      border: 2px solid rgba(255,255,255,.18);
      box-shadow: 0 10px 25px rgba(0,0,0,.18);
      flex: 0 0 auto;
      background: rgba(255,255,255,.10);
    }
    .avatar img{
      width:100%; height:100%;
      object-fit: cover;
      display:block;
    }

    .meta h2{
      margin:0;
      font-size: 18px;
      line-height: 1.2;
    }
    .meta .role{
      margin-top: 6px;
      font-size: 13px;
      color: var(--muted);
    }

    .tags{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top: 10px;
    }
    .tag{
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--line);
      color: var(--muted);
      background: rgba(255,255,255,.08);
    }

    .desc{
      margin: 2px 0 0;
      font-size: 13px;
      line-height: 1.7;
      color: var(--text);
      opacity: .92;
      display: -webkit-box;
      -webkit-line-clamp: 4;
      -webkit-box-orient: vertical;
      overflow:hidden;
    }

    .footer{
      margin-top:auto;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding-top: 10px;
      border-top: 1px solid var(--line);
    }

    .social a{
      text-decoration:none;
      color: var(--muted);
      margin-right: 10px;
      font-size: 18px;
      transition: color .2s ease, transform .2s ease;
      display:inline-block;
    }
    .social a:hover{ color: var(--accent); transform: translateY(-2px); }

    .more{
      border: 1px solid var(--line);
      background: rgba(255,255,255,.10);
      color: var(--text);
      padding: 8px 12px;
      border-radius: 12px;
      cursor:pointer;
      font-size: 13px;
      display:flex; align-items:center; gap:8px;
      user-select:none;
    }

    /* Empty state */
    .empty{
      grid-column: 1 / -1;
      padding: 26px;
      border: 1px dashed var(--line);
      border-radius: 16px;
      color: var(--muted);
      background: rgba(255,255,255,.06);
      text-align:center;
    }

    /* Join form section */
    .join{
      margin-top: 28px;
      border: 1px solid var(--line);
      border-radius: 18px;
      background: rgba(255,255,255,.08);
      backdrop-filter: blur(10px);
      overflow:hidden;
      box-shadow: var(--shadow);
    }
    .join-top{
      padding: 16px 16px;
      border-bottom: 1px solid var(--line);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      flex-wrap:wrap;
    }
    .join-top h3{ margin:0; font-size: 18px; }
    .join-top p{ margin:0; color: var(--muted); font-size: 13px; }

    .join-body{
      padding: 16px;
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 12px;
    }

    .input{
      grid-column: span 6;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .input.full{ grid-column: 1 / -1; }
    .input label{ font-size: 13px; color: var(--muted); }
    .input input, .input textarea{
      width:100%;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.10);
      color: var(--text);
      border-radius: 14px;
      padding: 12px 12px;
      outline:none;
      font-size: 14px;
    }
    .input textarea{ min-height: 110px; resize: vertical; }

    .join-actions{
      grid-column: 1 / -1;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      padding-top: 6px;
    }
    .hint{
      font-size: 12px;
      color: var(--muted);
      line-height:1.5;
    }
    .send{
      border: 1px solid rgba(47,124,255,.35);
      background: linear-gradient(90deg, rgba(47,124,255,.22), rgba(0,212,255,.18));
      color: var(--text);
      padding: 12px 14px;
      border-radius: 14px;
      cursor:pointer;
      display:flex;
      align-items:center;
      gap:10px;
      font-weight: 600;
      user-select:none;
    }
    .send:disabled{
      opacity:.6;
      cursor:not-allowed;
    }

    .status{
      grid-column: 1 / -1;
      padding: 12px 14px;
      border-radius: 14px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.06);
      color: var(--muted);
      display:none;
    }
    .status.show{ display:block; }
    .status.ok{ border-color: rgba(31,206,138,.35); color: var(--text); }
    .status.bad{ border-color: rgba(255,92,122,.35); color: var(--text); }

    /* Modal */
    .modal{
      position: fixed;
      inset: 0;
      display:none;
      align-items:center;
      justify-content:center;
      padding: 18px;
      background: rgba(0,0,0,.55);
      z-index: 50;
    }
    .modal.open{ display:flex; }
    .modal-box{
      width: min(760px, 100%);
      border-radius: 18px;
      border: 1px solid var(--line);
      background: var(--bg);
      box-shadow: 0 30px 90px rgba(0,0,0,.45);
      overflow:hidden;
    }
    .modal-top{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 10px;
      padding: 14px 16px;
      border-bottom: 1px solid var(--line);
    }
    .modal-top strong{ font-size: 15px; }
    .x{
      border:none;
      background: transparent;
      color: var(--muted);
      font-size: 22px;
      cursor:pointer;
      padding: 6px 10px;
      border-radius: 12px;
    }
    .x:hover{ background: rgba(255,255,255,.08); color: var(--text); }

    .modal-body{
      display:flex;
      gap: 16px;
      padding: 16px;
      flex-wrap:wrap;
    }
    .modal-body .big{
      width: 110px; height: 110px;
      border-radius: 22px;
      overflow:hidden;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.10);
      flex: 0 0 auto;
    }
    .modal-body .big img{ width:100%; height:100%; object-fit:cover; }
    .modal-info{
      flex: 1 1 260px;
      min-width: 260px;
    }
    .modal-info h2{ margin:0; font-size: 22px; }
    .modal-info .role{ margin: 6px 0 10px; color: var(--muted); }
    .modal-info p{ margin:0; line-height: 1.75; color: var(--text); opacity: .92; }

    .modal-links{
      padding: 0 16px 16px;
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
    }
    .chip{
      text-decoration:none;
      color: var(--text);
      border: 1px solid var(--line);
      background: rgba(255,255,255,.10);
      padding: 10px 12px;
      border-radius: 14px;
      display:flex;
      gap: 10px;
      align-items:center;
      font-size: 14px;
      min-width: 170px;
    }
    .chip i{ color: var(--muted); }
    .chip:hover{ border-color: rgba(47,124,255,.35); }

    @media (max-width: 980px){ .card{ grid-column: span 6; } }
    @media (max-width: 720px){
      .input{ grid-column: 1 / -1; }
    }
    @media (max-width: 620px){
      .field{ min-width: 100%; }
      .card{ grid-column: span 12; }
      .topbar{ align-items:stretch; }
      .title{ width:100%; justify-content:space-between; }
      .controls{ width:100%; }
      select, .btn{ width:100%; }
    }
  </style>
</head>

<body>
  <main class="wrap">
    <div class="topbar">
      <div class="title">
        <h1>Bizi≈Ñ komanda</h1>
        <span class="badge" id="countBadge">0 adam</span>
      </div>

      <div class="controls">
        <div class="field">
          <i class="fa-solid fa-magnifying-glass"></i>
          <input id="search" type="text" placeholder="Izlew: atƒ±, rolƒ±, m√°limeti..." />
        </div>

        <select id="roleFilter" title="Rol boyƒ±nsha filter">
          <option value="all">H√°mmesi</option>
          <option value="frontend">Frontend</option>
          <option value="backend">Backend</option>
          <option value="mentor">Mentor</option>
          <option value="design">Dizayn</option>
        </select>

        <select id="sort" title="Sortelew">
          <option value="az">Atƒ±: A‚ÄìZ</option>
          <option value="za">Atƒ±: Z‚ÄìA</option>
          <option value="rating">Reyting: joqarƒ±</option>
        </select>

        <button class="btn" id="themeBtn" title="Tema">
          <i class="fa-solid fa-moon"></i> Dark
        </button>
      </div>
    </div>

    <!-- Cards -->
    <section class="grid" id="grid"></section>

    <!-- Join form -->
    <section class="join" id="join">
      <div class="join-top">
        <div>
          <h3>üì© Bizge qosƒ±lƒ±≈Ñ (arza)</h3>
          <p>Forma toltƒ±rƒ±≈Ñ ‚Äî arza Telegram arqalƒ± jiberiledi.</p>
        </div>
        <span class="badge">Tez ja√Ωap qaytarƒ±w</span>
      </div>

      <form class="join-body" id="joinForm">
        <div class="input">
          <label>Atƒ±≈Ñƒ±z</label>
          <input name="name" required placeholder="Mƒ±sal: Atabek" />
        </div>

        <div class="input">
          <label>Telefon</label>
          <input name="phone" required placeholder="+998 90 123 45 67" />
        </div>

        <div class="input">
          <label>Qaysƒ± roldƒ± q√°lesiz?</label>
          <input name="role" required placeholder="Frontend / Backend / Mentor..." />
        </div>

        <div class="input">
          <label>Telegram username</label>
          <input name="tg" placeholder="@username" />
        </div>

        <div class="input full">
          <label>Qƒ±sqa xat / √≥zi≈Ñiz haqqƒ±nda</label>
          <textarea name="msg" required placeholder="√ìzi≈Ñizdi qƒ±sqa tanƒ±stƒ±rƒ±≈Ñ..."></textarea>
        </div>

        <div class="join-actions">
          <div class="hint">
            ‚ö†Ô∏è GitHub Pages‚Äôda bot token‚Äôni ashƒ±q qaldƒ±rƒ±w qawipsiz emes.<br/>
            Token bolmasa ‚Äî avtomat ‚Äúshare link‚Äù arqalƒ± jiberedi.
          </div>
          <button class="send" id="sendBtn" type="submit">
            <i class="fa-solid fa-paper-plane"></i> Arzanƒ± jiberiw
          </button>
        </div>

        <div class="status" id="statusBox"></div>
      </form>
    </section>
  </main>

  <!-- Modal -->
  <div class="modal" id="modal" aria-hidden="true">
    <div class="modal-box" role="dialog" aria-modal="true">
      <div class="modal-top">
        <strong>Profil</strong>
        <button class="x" id="closeModal" aria-label="Yapƒ±w">&times;</button>
      </div>
      <div class="modal-body">
        <div class="big"><img id="mImg" alt=""></div>
        <div class="modal-info">
          <h2 id="mName">‚Äî</h2>
          <div class="role" id="mRole">‚Äî</div>
          <p id="mDesc">‚Äî</p>
          <div class="tags" id="mTags" style="margin-top:12px"></div>
        </div>
      </div>
      <div class="modal-links" id="mLinks"></div>
    </div>
  </div>

  <script>
    // =======================
    // 1) Telegram settings
    // =======================
    // ‚ö†Ô∏è XAVFSIZLIK: Tokenni frontend ichida saqlash tavsiya etilmaydi.
    // Agar baribir ishlatsangiz, token/chat_id ni shu yerga yozing.
    // Aks holda, sistemada fallback ishlaydi (share link).
    const 6716412448:AAHMnqyy1pBDYUSkp1bcl_ozGQLYyfj6-Rk = ""; // masalan: "123456:ABC..."
    const 6578193442 = "";   // masalan: "-1001234567890" (kanal/guruh) yoki "123456789" (shaxs)

    // Share link (token bo'lmasa ham ishlaydi)
    const TELEGRAM_SHARE_TO = "https://t.me/share/url?url=";

    // =======================
    // 2) Default avatar (svg)
    // =======================
    const DEFAULT_AVATAR =
      'data:image/svg+xml;utf8,' +
      encodeURIComponent(`
        <svg xmlns="http://www.w3.org/2000/svg" width="240" height="240">
          <defs>
            <linearGradient id="g" x1="0" x2="1">
              <stop offset="0" stop-color="#2f7cff" stop-opacity="0.9"/>
              <stop offset="1" stop-color="#00d4ff" stop-opacity="0.9"/>
            </linearGradient>
          </defs>
          <rect width="100%" height="100%" rx="32" fill="url(#g)"/>
          <circle cx="120" cy="92" r="42" fill="rgba(255,255,255,0.92)"/>
          <path d="M52 206c10-44 44-68 68-68s58 24 68 68" fill="rgba(255,255,255,0.92)"/>
          <text x="120" y="30" text-anchor="middle" font-size="16" fill="rgba(255,255,255,0.95)" font-family="Segoe UI, Arial">UNI TEAM</text>
        </svg>
      `);

    // =======================
    // 3) Team data
    // =======================
    const team = [
      {
        id: "atabek",
        name: "K√≥shkinbaev Atabek",
        role: "Joybar tiykarshƒ±sƒ± & Frontend programmist",
        category: "frontend",
        img: "atabek.jfif",
        rating: 4.9,
        topMentor: true,
        tags: ["Frontend", "UI/UX", "Founder"],
        desc: `Qaraqalpaq m√°mleketlik universiteti 2-kurs studenti, "UNI academy" klubƒ±nda kompyuter sawatqanlƒ±«µƒ± kursƒ± mentori. "Qaraqalpaq S√≥zlik" joybarƒ±nƒ±≈Ñ ideya avtorƒ± h√°m basshƒ±sƒ±. Sayt dizayneri, paydalanƒ±wshƒ± interfeysi h√°m frontend programmist.`,
        links: [
          { fa: "fa-telegram", label: "Telegram", url: "https://t.me/atabek_offical01" },
          { fa: "fa-instagram", label: "Instagram", url: "https://instagram.com/atabekkoshkinbaev?igsh=MTYweGdmZTJ2eTM2ZA==" }
        ]
      },
      {
        id: "abdirasul",
        name: "√ìtebaev Abdirasul",
        role: "Backend programmist & texnik xizmetker",
        category: "backend",
        img: "abdirasul.jfif",
        rating: 4.7,
        topMentor: false,
        tags: ["Backend", "Firebase", "DevOps"],
        desc: `Qaraqalpaq m√°mleketlik universiteti 2-kurs studenti, joybar she≈Ñberinde backend sistemalar h√°m texnikalƒ±q jumƒ±slar menen shu«µƒ±llanadƒ±. Firebase ma«µlƒ±wmatlar bazasƒ±n integraciyalaw, s√≥zler h√°m t√∫sinikler bazasƒ±n basqaradƒ±.`,
        links: [
          { fa: "fa-telegram", label: "Telegram", url: "https://t.me/Abdirasul_Otebaev" },
          { fa: "fa-instagram", label: "Instagram", url: "https://www.instagram.com/abdirasul_otebaev?igsh=MWJjeG01NnFqamhrOQ==" }
        ]
      }
    ];

    // =======================
    // 4) DOM helpers
    // =======================
    const $ = (s) => document.querySelector(s);
    const grid = $("#grid");
    const search = $("#search");
    const roleFilter = $("#roleFilter");
    const sort = $("#sort");
    const countBadge = $("#countBadge");
    const themeBtn = $("#themeBtn");

    // =======================
    // 5) Theme (localStorage)
    // =======================
    const savedTheme = localStorage.getItem("theme");
    if(savedTheme === "dark") document.body.classList.add("dark");
    updateThemeBtn();

    themeBtn.addEventListener("click", () => {
      document.body.classList.toggle("dark");
      localStorage.setItem("theme", document.body.classList.contains("dark") ? "dark" : "light");
      updateThemeBtn();
    });

    function updateThemeBtn(){
      const dark = document.body.classList.contains("dark");
      themeBtn.innerHTML = dark
        ? `<i class="fa-solid fa-sun"></i> Light`
        : `<i class="fa-solid fa-moon"></i> Dark`;
    }

    // =======================
    // 6) Render cards
    // =======================
    function render(){
      const q = search.value.trim().toLowerCase();
      const cat = roleFilter.value;

      let list = [...team];

      if(cat !== "all") list = list.filter(p => p.category === cat);

      if(q){
        list = list.filter(p =>
          (p.name + " " + p.role + " " + p.desc + " " + (p.tags||[]).join(" "))
            .toLowerCase().includes(q)
        );
      }

      if(sort.value === "rating"){
        list.sort((a,b) => (b.rating ?? 0) - (a.rating ?? 0));
      }else{
        list.sort((a,b) => {
          const A = a.name.toLowerCase();
          const B = b.name.toLowerCase();
          return sort.value === "az" ? A.localeCompare(B) : B.localeCompare(A);
        });
      }

      countBadge.textContent = `${list.length} adam`;
      grid.innerHTML = "";

      if(!list.length){
        grid.innerHTML = `<div class="empty">Hech n√°rse tabƒ±lmadƒ± üòï Qƒ±dƒ±rƒ±w so'zlerin √≥zgertip k√≥ri≈Ñ.</div>`;
        return;
      }

      for(const p of list){
        const card = document.createElement("article");
        card.className = "card";
        card.dataset.id = p.id;

        card.innerHTML = `
          <div class="card-inner">
            <div class="toprow">
              <div class="rank" title="Reyting">
                <i class="fa-solid fa-star"></i>
                <span>${(p.rating ?? 0).toFixed(1)}</span>
              </div>
              ${p.topMentor ? `
                <div class="top-mentor" title="Top mentor">
                  <i class="fa-solid fa-crown"></i> Top mentor
                </div>` : ``}
            </div>

            <div class="head">
              <div class="avatar">
                <img src="${p.img}" alt="${p.name}" loading="lazy"
                     onerror="this.onerror=null; this.src='${DEFAULT_AVATAR}'">
              </div>
              <div class="meta">
                <h2>${p.name}</h2>
                <div class="role">${p.role}</div>
                <div class="tags">
                  ${(p.tags||[]).slice(0,3).map(t => `<span class="tag">${t}</span>`).join("")}
                </div>
              </div>
            </div>

            <p class="desc">${p.desc}</p>

            <div class="footer">
              <div class="social">
                ${(p.links||[]).slice(0,3).map(l => `
                  <a href="${l.url}" target="_blank" rel="noopener" title="${l.label}">
                    <i class="fab ${l.fa}"></i>
                  </a>
                `).join("")}
              </div>

              <button class="more" data-open="${p.id}">
                Batafsil <i class="fa-solid fa-arrow-right"></i>
              </button>
            </div>
          </div>
        `;

        grid.appendChild(card);
      }

      observeCards();
    }

    // =======================
    // 7) Scroll reveal
    // =======================
    let observer;
    function observeCards(){
      if(observer) observer.disconnect();
      observer = new IntersectionObserver((entries) => {
        entries.forEach(e => {
          if(e.isIntersecting){
            e.target.classList.add("show");
            observer.unobserve(e.target);
          }
        });
      }, { threshold: 0.12 });

      document.querySelectorAll(".card").forEach((c, i) => {
        c.style.transitionDelay = (i * 70) + "ms";
        observer.observe(c);
      });
    }

    // =======================
    // 8) Modal
    // =======================
    const modal = $("#modal");
    const closeModal = $("#closeModal");
    const mImg = $("#mImg");
    const mName = $("#mName");
    const mRole = $("#mRole");
    const mDesc = $("#mDesc");
    const mTags = $("#mTags");
    const mLinks = $("#mLinks");

    function openModal(id){
      const p = team.find(x => x.id === id);
      if(!p) return;

      mImg.src = p.img;
      mImg.alt = p.name;
      mImg.onerror = () => { mImg.src = DEFAULT_AVATAR; };

      mName.textContent = p.name;
      mRole.textContent = `${p.role} ‚Ä¢ ‚≠ê ${ (p.rating ?? 0).toFixed(1) }`;
      mDesc.textContent = p.desc;

      mTags.innerHTML = (p.tags||[]).map(t => `<span class="tag">${t}</span>`).join("");

      mLinks.innerHTML = (p.links||[]).map(l => `
        <a class="chip" href="${l.url}" target="_blank" rel="noopener">
          <i class="fab ${l.fa}"></i>
          ${l.label}
          <i class="fa-solid fa-up-right-from-square" style="margin-left:auto; opacity:.75"></i>
        </a>
      `).join("");

      modal.classList.add("open");
      modal.setAttribute("aria-hidden", "false");
      document.body.style.overflow = "hidden";
    }
    function close(){
      modal.classList.remove("open");
      modal.setAttribute("aria-hidden", "true");
      document.body.style.overflow = "";
    }
    closeModal.addEventListener("click", close);
    modal.addEventListener("click", (e) => { if(e.target === modal) close(); });
    window.addEventListener("keydown", (e) => { if(e.key === "Escape") close(); });

    document.addEventListener("click", (e) => {
      const btn = e.target.closest("[data-open]");
      if(btn) openModal(btn.dataset.open);
    });

    // =======================
    // 9) Join form -> Telegram
    // =======================
    const joinForm = $("#joinForm");
    const sendBtn = $("#sendBtn");
    const statusBox = $("#statusBox");

    function setStatus(type, text){
      statusBox.className = "status show " + (type || "");
      statusBox.textContent = text;
    }

    function buildMessage(data){
      const lines = [
        "üì© *Yangi arza (Komanda)*",
        "",
        `üë§ *Atƒ±:* ${data.name}`,
        `üìû *Telefon:* ${data.phone}`,
        `üß© *Rol:* ${data.role}`,
        `üí¨ *Telegram:* ${data.tg || "-"}`,
        "",
        `üìù *Xat:*`,
        `${data.msg}`
      ];
      return lines.join("\n");
    }

    async function sendToTelegramBot(text){
      const url = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;
      const payload = {
        chat_id: TELEGRAM_CHAT_ID,
        text,
        parse_mode: "Markdown"
      };

      const res = await fetch(url, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      });

      if(!res.ok){
        const err = await res.text().catch(()=> "");
        throw new Error("Telegram API error: " + err);
      }
      return true;
    }

    function fallbackShareLink(text){
      // share url telegram
      const share = TELEGRAM_SHARE_TO + encodeURIComponent("https://uni.academy") + "&text=" + encodeURIComponent(text);
      window.open(share, "_blank");
    }

    joinForm.addEventListener("submit", async (e) => {
      e.preventDefault();

      const formData = new FormData(joinForm);
      const data = Object.fromEntries(formData.entries());
      const text = buildMessage(data);

      sendBtn.disabled = true;
      setStatus("", "‚è≥ Jiberilip atƒ±r...");

      try{
        if(TELEGRAM_BOT_TOKEN && TELEGRAM_CHAT_ID){
          await sendToTelegramBot(text);
          setStatus("ok", "‚úÖ Arza Telegram«µa jiberildi!");
          joinForm.reset();
        } else {
          setStatus("bad", "‚ö†Ô∏è Token/Chat ID joq. Telegram share link ashƒ±ldƒ± (forma matni tayyor).");
          fallbackShareLink(text);
        }
      } catch(err){
        setStatus("bad", "‚ùå Q√°telik: " + (err?.message || "Jiberilmedi"));
        // fallback ham beramiz
        fallbackShareLink(text);
      } finally{
        sendBtn.disabled = false;
      }
    });

    // =======================
    // 10) Controls listeners
    // =======================
    search.addEventListener("input", render);
    roleFilter.addEventListener("change", render);
    sort.addEventListener("change", render);

    render();
  </script>
</body>
</html>

