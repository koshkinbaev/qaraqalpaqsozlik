<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
  <title>Qaraqalpaq_s√≥zlik - Interaktiv</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <script src="https://cdn.tailwindcss.com"></script>

  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    body { font-family: 'Roboto', sans-serif; }
    * { transition: background-color .25s ease, color .25s ease, border-color .25s ease, box-shadow .25s ease, transform .25s ease; }

    /* Mobil uchun qulay ‚Äútap‚Äù */
    button, a { -webkit-tap-highlight-color: transparent; }

    /* Safe-area (iPhone notch) */
    .safe-pad { padding-bottom: env(safe-area-inset-bottom); }

    /* Gradient tekst (brend) */
    .brand-grad{
      background: linear-gradient(90deg, rgba(37,99,235,1), rgba(14,165,233,1));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
  </style>

  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          boxShadow: {
            soft: "0 12px 40px rgba(0,0,0,.12)"
          }
        }
      }
    }
  </script>
</head>

<body class="bg-slate-50 text-slate-800 min-h-screen">
  <div id="root"></div>

  <script type="text/babel">
    const { useEffect, useMemo, useRef, useState } = React;

    const STORAGE_KEYS = {
      theme: "qs_theme",
      lang: "qs_lang",
      chat: "qs_chat_v1"
    };

    const LANGS = [
      { code: "uz", label: "O‚Äòzbek" },
      { code: "kaa", label: "Qaraqalpaq" },
      { code: "ru", label: "–†—É—Å—Å–∫–∏–π" },
    ];

    const i18n = {
      uz: {
        brand: "Qaraqalpaq So‚Äòzlik",
        heroTitle: "Qaraqalpaq_s√≥zlik ‚Äî Interaktiv So‚Äòzlik",
        heroSubtitle: "So‚Äòz ma‚Äônolari, misollar va audio talaffuz ‚Äî barchasi bir joyda.",
        navNews: "Yangiliklar",
        navFeedback: "Fikr va taklif",
        navRegister: "Ro‚Äòyxatdan o‚Äòtish",
        navTeam: "Jamoa",
        quickTitle: "Bo‚Äòlimlar",
        cardDictTitle: "üìï So‚Äòzliklar",
        cardDictDesc: "So‚Äòzlarning izohi, misollar va qo‚Äòllanishi. O‚Äòquvchi, talaba va tilshunoslar uchun foydali.",
        cardAudioTitle: "üîä Audio",
        cardAudioDesc: "So‚Äòzlarning talaffuzini tinglang, o‚Äòrganing va amalda qo‚Äòllang.",
        cardOpen: "Kirish",
        socialTitle: "Biz bilan bog‚Äòlaning",
        aboutTitle: "üìå Sayt haqida",
        aboutText: "‚ÄúQaraqalpaq_s√≥zligi‚Äù ‚Äî qaraqalpoq tilining so‚Äòz boyligini jamlagan zamonaviy izohli platforma. Maqsad ‚Äî tilni sevish, o‚Äòrganish va asrash.",
        rememberTitle: "üìñ Esda saqlang!",
        q1: "‚ÄúNiyatingiz chin bo‚Äòlsa, maqsadingizga yetasiz!‚Äù",
        q2: "‚ÄúHarakat albatta natijasini beradi.‚Äù",
        q3: "‚ÄúIlm ‚Äî bu NUR!‚Äù",
        author: "‚Äì Ko‚Äòshkinbaev Atabek",
        contactTitle: "üì¨ Savolingiz bormi?",
        founder: "Loyiha asoschisi & Frontend dasturchi",
        founderName: "Ko‚Äòshkinbaev Atabek",
        tech: "Backend dasturchi & Texnik xodim",
        techName: "O‚Äòtebaev Abdirasul",
        rights: "Barcha huquqlar himoyalangan.",
        themeDay: "Kunduz",
        themeNight: "Tungi",
        searchPlaceholder: "So‚Äòz qidiring (demo)...",
        toastSaved: "Sozlamalar saqlandi ‚úÖ",
        toastOnline: "Internet qaytdi ‚úÖ",
        toastOffline: "Internet yo‚Äòq (offline) ‚ö†Ô∏è",
        aiBtn: "AI Yordamchi",
        aiTitle: "Gemini AI ‚Äî Savol-javob",
        aiHint: "Savolingizni yozing. AI avtomatik javob beradi.",
        aiPlaceholder: "Masalan: 'Imidj nima?' yoki 'So‚Äòzlikdan qanday foydalanaman?'",
        aiSend: "Yuborish",
        aiClear: "Chatni tozalash",
        aiThinking: "O‚Äòylayapman...",
        aiErr: "Xatolik. Server ishlayaptimi? (server.js 3000-port)",
        goTop: "Yuqoriga",
        sections: "Bo‚Äòlimlar",
        openSearch: "Qidiruvga o‚Äòtish",
      },
      kaa: {
        brand: "Qaraqalpaq S√≥zlik",
        heroTitle: "Qaraqalpaq_s√≥zlik ‚Äî Interaktiv S√≥zlik",
        heroSubtitle: "S√≥z m√°nileri, mƒ±sallar h√°m audio talaffuz ‚Äî b√°ri bir jerde.",
        navNews: "Ja≈Ñalƒ±qlar",
        navFeedback: "Pikir h√°m usƒ±nƒ±s",
        navRegister: "Dizimnen √≥tiw",
        navTeam: "Komanda",
        quickTitle: "B√≥limler",
        cardDictTitle: "üìï S√≥zlikler",
        cardDictDesc: "H√°rbir s√≥zdi≈Ñ t√∫sindirmesi h√°m mƒ±sallar. Oqƒ±wshƒ±lar h√°m studentler ushƒ±n paydalƒ±.",
        cardAudioTitle: "üîä Audio",
        cardAudioDesc: "Talaffuzdƒ± tƒ±≈Ñla≈Ñ, √∫yreni≈Ñ h√°m qollanƒ±≈Ñ.",
        cardOpen: "Kiriw",
        socialTitle: "Biz benen baylanƒ±sƒ±≈Ñ",
        aboutTitle: "üìå Sayt haqqƒ±nda",
        aboutText: "‚ÄúQaraqalpaq_s√≥zligi‚Äù ‚Äî s√≥z baylƒ±«µƒ±n j√°mlegen platforma. Maqsat ‚Äî tilimizdi q√°dirlew h√°m saqlaw.",
        rememberTitle: "üìñ Este saqla≈Ñ!",
        q1: "‚ÄúNiyeti≈Ñ shƒ±n bolsa maqseti≈Ñe jetese≈Ñ!‚Äù",
        q2: "‚ÄúH√°reket √°lbette n√°tiyjesin beredi.‚Äù",
        q3: "‚ÄúIlim ‚Äî bul NUR!‚Äù",
        author: "‚Äì K√≥shkinbaev Atabek",
        contactTitle: "üì¨ Sorawƒ±≈Ñƒ±z bar ma?",
        founder: "Joybar tiykarshƒ±sƒ± & Frontend programmist",
        founderName: "K√≥shkinbaev Atabek",
        tech: "Backend programmist & Texnik xizmetker",
        techName: "√ìtebaev Abdirasul",
        rights: "Barlƒ±q huqƒ±qlar qor«µal«µan.",
        themeDay: "K√∫ndiz",
        themeNight: "T√∫ngi",
        searchPlaceholder: "S√≥z izlew (demo)...",
        toastSaved: "Sazlawlar saqlandƒ± ‚úÖ",
        toastOnline: "Internet qayttƒ± ‚úÖ",
        toastOffline: "Internet joq (offline) ‚ö†Ô∏è",
        aiBtn: "AI J√°rdemshi",
        aiTitle: "Gemini AI ‚Äî Soraw-juwap",
        aiHint: "Sorawƒ±≈Ñƒ±zdƒ± jazƒ±≈Ñ. AI avtomatik juwap beredi.",
        aiPlaceholder: "Mƒ±sal: 'Imidj ne?' yaki 'S√≥zlikten qalay paydalanaman?'",
        aiSend: "Jiberiw",
        aiClear: "Chattƒ± tazalaw",
        aiThinking: "Oylap atƒ±rman...",
        aiErr: "Q√°telik. Server islep turƒ±ptƒ± ma? (server.js 3000-port)",
        goTop: "Joqarƒ±«µa",
        sections: "B√≥limler",
        openSearch: "Izlewge √≥tiw",
      },
      ru: {
        brand: "Qaraqalpaq –°–ª–æ–≤–∞—Ä—å",
        heroTitle: "Qaraqalpaq_s√≥zlik ‚Äî –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å",
        heroSubtitle: "–ó–Ω–∞—á–µ–Ω–∏—è —Å–ª–æ–≤, –ø—Ä–∏–º–µ—Ä—ã –∏ –∞—É–¥–∏–æ –ø—Ä–æ–∏–∑–Ω–æ—à–µ–Ω–∏–µ ‚Äî –≤—Å—ë –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ.",
        navNews: "–ù–æ–≤–æ—Å—Ç–∏",
        navFeedback: "–û—Ç–∑—ã–≤—ã –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è",
        navRegister: "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è",
        navTeam: "–ö–æ–º–∞–Ω–¥–∞",
        quickTitle: "–†–∞–∑–¥–µ–ª—ã",
        cardDictTitle: "üìï –°–ª–æ–≤–∞—Ä—å",
        cardDictDesc: "–ü–æ–¥—Ä–æ–±–Ω—ã–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è —Å–ª–æ–≤ –∏ –ø—Ä–∏–º–µ—Ä—ã —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è. –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π.",
        cardAudioTitle: "üîä –ê—É–¥–∏–æ",
        cardAudioDesc: "–°–ª—É—à–∞–π—Ç–µ –ø—Ä–æ–∏–∑–Ω–æ—à–µ–Ω–∏–µ —Å–ª–æ–≤, —É—á–∏—Ç–µ –∏ –ø—Ä–∏–º–µ–Ω—è–π—Ç–µ –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ.",
        cardOpen: "–û—Ç–∫—Ä—ã—Ç—å",
        socialTitle: "–°–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏",
        aboutTitle: "üìå –û —Å–∞–π—Ç–µ",
        aboutText: "‚ÄúQaraqalpaq_s√≥zligi‚Äù ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞, —Å–æ–±–∏—Ä–∞—é—â–∞—è –±–æ–≥–∞—Ç—Å—Ç–≤–æ –∫–∞—Ä–∞–∫–∞–ª–ø–∞–∫—Å–∫–æ–≥–æ —è–∑—ã–∫–∞. –¶–µ–ª—å ‚Äî –ª—é–±–∏—Ç—å, –∏–∑—É—á–∞—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —è–∑—ã–∫.",
        rememberTitle: "üìñ –ó–∞–ø–æ–º–Ω–∏—Ç–µ!",
        q1: "¬´–ï—Å–ª–∏ –Ω–∞–º–µ—Ä–µ–Ω–∏–µ –∏—Å–∫—Ä–µ–Ω–Ω–µ–µ ‚Äî –¥–æ—Å—Ç–∏–≥–Ω–µ—à—å —Ü–µ–ª–∏!¬ª",
        q2: "¬´–î–µ–π—Å—Ç–≤–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–∞—Å—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.¬ª",
        q3: "¬´–ó–Ω–∞–Ω–∏–µ ‚Äî —ç—Ç–æ –°–í–ï–¢!¬ª",
        author: "‚Äì Koshkinbaev Atabek",
        contactTitle: "üì¨ –ï—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã?",
        founder: "–û—Å–Ω–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ & Frontend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫",
        founderName: "Koshkinbaev Atabek",
        tech: "Backend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ & –¢–µ—Ö. —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç",
        techName: "O‚Äòtebaev Abdirasul",
        rights: "–í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.",
        themeDay: "–î–µ–Ω—å",
        themeNight: "–ù–æ—á—å",
        searchPlaceholder: "–ü–æ–∏—Å–∫ —Å–ª–æ–≤–∞ (–¥–µ–º–æ)...",
        toastSaved: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã ‚úÖ",
        toastOnline: "–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω ‚úÖ",
        toastOffline: "–ù–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ (offline) ‚ö†Ô∏è",
        aiBtn: "AI –ü–æ–º–æ—â–Ω–∏–∫",
        aiTitle: "Gemini AI ‚Äî –í–æ–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã",
        aiHint: "–ù–∞–ø–∏—à–∏—Ç–µ –≤–æ–ø—Ä–æ—Å. AI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–≤–µ—Ç–∏—Ç.",
        aiPlaceholder: "–ù–∞–ø—Ä–∏–º–µ—Ä: '–ß—Ç–æ —Ç–∞–∫–æ–µ –∏–º–∏–¥–∂?'",
        aiSend: "–û—Ç–ø—Ä–∞–≤–∏—Ç—å",
        aiClear: "–û—á–∏—Å—Ç–∏—Ç—å —á–∞—Ç",
        aiThinking: "–î—É–º–∞—é...",
        aiErr: "–û—à–∏–±–∫–∞. –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω? (server.js –ø–æ—Ä—Ç 3000)",
        goTop: "–ù–∞–≤–µ—Ä—Ö",
        sections: "–†–∞–∑–¥–µ–ª—ã",
        openSearch: "–û—Ç–∫—Ä—ã—Ç—å –ø–æ–∏—Å–∫",
      },
    };

    const cx = (...classes) => classes.filter(Boolean).join(" ");

    function applyTheme(theme) {
      const root = document.documentElement;
      if (theme === "dark") root.classList.add("dark");
      else root.classList.remove("dark");
      document.body.className = cx(
        "min-h-screen",
        "antialiased",
        theme === "dark" ? "bg-slate-950 text-slate-100" : "bg-slate-50 text-slate-800"
      );
    }

    function Toast({ show, text }) {
      return (
        <div className={cx(
          "fixed bottom-5 left-1/2 -translate-x-1/2 z-[9999] safe-pad",
          "px-4 py-2 rounded-2xl shadow-soft backdrop-blur",
          "border text-sm font-semibold",
          show ? "opacity-100 translate-y-0" : "opacity-0 translate-y-2 pointer-events-none",
          "bg-white/90 border-slate-200 text-slate-900",
          "dark:bg-slate-900/80 dark:border-slate-700 dark:text-slate-100"
        )}>
          {text}
        </div>
      );
    }

    function BackToTop({ show, onClick, t }) {
      return (
        <button
          onClick={onClick}
          className={cx(
            "fixed right-4 bottom-20 md:bottom-6 z-[9997] safe-pad",
            "rounded-2xl px-4 py-3 font-extrabold shadow-soft border",
            "bg-white/90 dark:bg-slate-900/80 backdrop-blur",
            "border-slate-200 dark:border-slate-700",
            "text-slate-900 dark:text-slate-100",
            "hover:shadow-lg active:scale-[0.99]",
            show ? "opacity-100 translate-y-0" : "opacity-0 translate-y-2 pointer-events-none"
          )}
          type="button"
        >
          <i className="fa-solid fa-arrow-up mr-2"></i>{t.goTop}
        </button>
      );
    }

    function ChatModal({ open, onClose, t, lang }) {
      const [input, setInput] = useState("");
      const [loading, setLoading] = useState(false);
      const [err, setErr] = useState("");
      const listRef = useRef(null);

      const [messages, setMessages] = useState(() => {
        try {
          const raw = localStorage.getItem(STORAGE_KEYS.chat);
          const parsed = raw ? JSON.parse(raw) : {};
          return parsed?.[lang] || [{ role: "ai", text: t.aiHint }];
        } catch {
          return [{ role: "ai", text: t.aiHint }];
        }
      });

      useEffect(() => {
        const raw = localStorage.getItem(STORAGE_KEYS.chat);
        const parsed = raw ? JSON.parse(raw) : {};
        parsed[lang] = messages;
        localStorage.setItem(STORAGE_KEYS.chat, JSON.stringify(parsed));
      }, [messages, lang]);

      useEffect(() => {
        if (listRef.current) listRef.current.scrollTop = listRef.current.scrollHeight;
      }, [messages, loading]);

      async function send() {
        const text = input.trim();
        if (!text || loading) return;

        setErr("");
        setInput("");
        setMessages(prev => [...prev, { role: "user", text }]);
        setLoading(true);

        try {
          const r = await fetch("http://localhost:3000/api/gemini", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              message: text,
              lang,
              context: "Bu sayt Qaraqalpaq_s√≥zlik: so'zlar izohi, misollar va audio talaffuz."
            })
          });

          const data = await r.json();
          if (!r.ok) throw new Error(data?.error || "Request failed");
          setMessages(prev => [...prev, { role: "ai", text: data.text }]);
        } catch (e) {
          setErr(t.aiErr);
        } finally {
          setLoading(false);
        }
      }

      function onKeyDown(e) {
        if (e.key === "Enter" && !e.shiftKey) {
          e.preventDefault();
          send();
        }
      }

      function clearChat() {
        setMessages([{ role: "ai", text: t.aiHint }]);
      }

      if (!open) return null;

      return (
        <div className="fixed inset-0 z-[9998]">
          <div className="absolute inset-0 bg-black/55" onClick={onClose}></div>

          <div className="absolute inset-x-0 bottom-0 md:inset-0 md:flex md:items-center md:justify-center p-3 safe-pad">
            <div className="w-full md:max-w-2xl bg-white dark:bg-slate-950 border border-slate-200 dark:border-slate-800 rounded-3xl shadow-2xl overflow-hidden">
              <div className="flex items-center justify-between px-4 md:px-5 py-4 border-b border-slate-200 dark:border-slate-800">
                <div className="flex items-center gap-3">
                  <div className="w-10 h-10 rounded-2xl bg-blue-600/10 dark:bg-blue-500/15 flex items-center justify-center">
                    <i className="fa-solid fa-wand-magic-sparkles text-blue-700 dark:text-blue-300"></i>
                  </div>
                  <div>
                    <div className="font-extrabold text-slate-900 dark:text-white">{t.aiTitle}</div>
                    <div className="text-xs text-slate-500 dark:text-slate-300">API: server.js ‚Üí /api/gemini</div>
                  </div>
                </div>
                <div className="flex items-center gap-2">
                  <button
                    onClick={clearChat}
                    className="px-3 py-2 rounded-xl text-sm font-extrabold border border-slate-200 dark:border-slate-800 hover:shadow"
                    type="button"
                  >
                    <i className="fa-solid fa-broom mr-2"></i>{t.aiClear}
                  </button>
                  <button
                    onClick={onClose}
                    className="w-11 h-11 rounded-xl border border-slate-200 dark:border-slate-800 hover:shadow"
                    type="button"
                    aria-label="close"
                  >
                    <i className="fa-solid fa-xmark"></i>
                  </button>
                </div>
              </div>

              <div ref={listRef} className="h-[55vh] md:h-[420px] overflow-auto px-4 md:px-5 py-4 space-y-3">
                {messages.map((m, idx) => (
                  <div key={idx} className={cx("flex", m.role === "user" ? "justify-end" : "justify-start")}>
                    <div className={cx(
                      "max-w-[88%] md:max-w-[85%] rounded-2xl px-4 py-3 text-sm leading-relaxed whitespace-pre-wrap",
                      m.role === "user"
                        ? "bg-blue-600 text-white"
                        : "bg-slate-100 dark:bg-slate-900 text-slate-900 dark:text-slate-100 border border-slate-200 dark:border-slate-800"
                    )}>
                      {m.text}
                    </div>
                  </div>
                ))}

                {loading && (
                  <div className="flex justify-start">
                    <div className="max-w-[85%] rounded-2xl px-4 py-3 text-sm bg-slate-100 dark:bg-slate-900 border border-slate-200 dark:border-slate-800">
                      <i className="fa-solid fa-spinner fa-spin mr-2"></i>{t.aiThinking}
                    </div>
                  </div>
                )}

                {err && (
                  <div className="rounded-2xl px-4 py-3 text-sm bg-red-50 dark:bg-red-950/40 border border-red-200 dark:border-red-900 text-red-700 dark:text-red-200">
                    <i className="fa-solid fa-triangle-exclamation mr-2"></i>{err}
                  </div>
                )}
              </div>

              <div className="px-4 md:px-5 py-4 border-t border-slate-200 dark:border-slate-800">
                <div className="flex gap-2">
                  <textarea
                    className="w-full resize-none h-12 md:h-14 rounded-2xl px-4 py-3 border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 outline-none"
                    placeholder={t.aiPlaceholder}
                    value={input}
                    onChange={(e) => setInput(e.target.value)}
                    onKeyDown={onKeyDown}
                  />
                  <button
                    onClick={send}
                    disabled={loading}
                    className={cx(
                      "px-5 rounded-2xl font-extrabold",
                      "bg-blue-600 text-white hover:bg-blue-700 active:scale-[0.99]",
                      loading ? "opacity-70 cursor-not-allowed" : ""
                    )}
                    type="button"
                  >
                    <i className="fa-solid fa-paper-plane mr-2"></i>{t.aiSend}
                  </button>
                </div>
                <div className="mt-2 text-xs text-slate-500 dark:text-slate-300">
                  Enter ‚Äî yuborish, Shift+Enter ‚Äî yangi qator
                </div>
              </div>
            </div>
          </div>
        </div>
      );
    }

    function App() {
      const [theme, setTheme] = useState(() => localStorage.getItem(STORAGE_KEYS.theme) || "light");
      const [lang, setLang] = useState(() => localStorage.getItem(STORAGE_KEYS.lang) || "kaa");
      const [menuOpen, setMenuOpen] = useState(false);
      const [toast, setToast] = useState({ show:false, text:"" });
      const [chatOpen, setChatOpen] = useState(false);
      const [showTop, setShowTop] = useState(false);

      const [query, setQuery] = useState("");
      const [suggestOpen, setSuggestOpen] = useState(false);

      const t = useMemo(() => i18n[lang] || i18n.kaa, [lang]);

      const suggestions = useMemo(() => {
        const base = [
          { label: "Imidj nima?", go: "izlew.html" },
          { label: "Diktsiya nima?", go: "izlew.html" },
          { label: "Boshlovchilik qoidalari", go: "izlew.html" },
          { label: "Audio talaffuz", go: "qosiq.html" },
        ];
        const q = query.trim().toLowerCase();
        if (!q) return base.slice(0, 4);
        return base.filter(x => x.label.toLowerCase().includes(q)).slice(0, 4);
      }, [query]);

      function showToast(text) {
        setToast({ show:true, text });
        window.clearTimeout(window.__qs_toast);
        window.__qs_toast = window.setTimeout(() => setToast({ show:false, text:"" }), 1700);
      }

      useEffect(() => {
        applyTheme(theme);
        localStorage.setItem(STORAGE_KEYS.theme, theme);
      }, [theme]);

      useEffect(() => {
        localStorage.setItem(STORAGE_KEYS.lang, lang);
      }, [lang]);

      useEffect(() => {
        const onScroll = () => setShowTop(window.scrollY > 500);
        onScroll();
        window.addEventListener("scroll", onScroll, { passive:true });
        return () => window.removeEventListener("scroll", onScroll);
      }, []);

      useEffect(() => {
        const onOnline = () => showToast(t.toastOnline);
        const onOffline = () => showToast(t.toastOffline);
        window.addEventListener("online", onOnline);
        window.addEventListener("offline", onOffline);
        return () => {
          window.removeEventListener("online", onOnline);
          window.removeEventListener("offline", onOffline);
        };
      }, [t]);

      function handleThemeToggle() {
        setTheme(p => (p === "dark" ? "light" : "dark"));
        showToast(t.toastSaved);
      }
      function handleLangChange(code) {
        setLang(code);
        showToast(t.toastSaved);
      }

      const nav = [
        { label: t.navNews, href: "janaliq.html" },
        { label: t.navFeedback, href: "fikir1.html" },
        { label: t.navRegister, href: "baylanƒ±s.html" },
        { label: t.navTeam, href: "komanda.html" },
      ];

      function goSearch() {
        // demo: qidiruv sahifasiga o‚Äòtish
        window.location.href = "izlew.html";
      }

      function onSearchKey(e) {
        if (e.key === "Enter") goSearch();
        if (e.key === "Escape") setSuggestOpen(false);
      }

      function scrollTop() {
        window.scrollTo({ top:0, behavior:"smooth" });
      }

      return (
        <div className="min-h-screen">
          <Toast show={toast.show} text={toast.text} />
          <ChatModal open={chatOpen} onClose={() => setChatOpen(false)} t={t} lang={lang} />
          <BackToTop show={showTop} onClick={scrollTop} t={t} />

          {/* HERO */}
          <header
            className="relative overflow-hidden"
            style={{
              backgroundImage: "url('na«µƒ±s.jpg')",
              backgroundSize: "cover",
              backgroundPosition: "center"
            }}
          >
            <div className="absolute inset-0 bg-gradient-to-r from-black/75 via-black/45 to-black/75"></div>
            <div className="absolute inset-0 opacity-30" style={{
              background: "radial-gradient(circle at 20% 30%, rgba(59,130,246,.55), transparent 45%), radial-gradient(circle at 80% 20%, rgba(14,165,233,.5), transparent 40%)"
            }}></div>

            <div className="relative max-w-6xl mx-auto px-4 sm:px-6 py-14 md:py-20">
              <div className="flex flex-col gap-6">
                <h1 className="text-[clamp(1.7rem,4.2vw,3.2rem)] font-extrabold tracking-tight text-white drop-shadow">
                  {t.heroTitle}
                </h1>
                <p className="text-white/90 max-w-2xl text-[clamp(0.98rem,2.1vw,1.1rem)] leading-relaxed">
                  {t.heroSubtitle}
                </p>

                {/* Search */}
                <div className="mt-2 max-w-xl">
                  <div className="relative">
                    <div className="flex items-center gap-2 bg-white/95 dark:bg-slate-900/70 rounded-2xl p-2 border border-white/30 dark:border-slate-700 backdrop-blur shadow-lg">
                      <span className="px-2 text-slate-600 dark:text-slate-200">
                        <i className="fa-solid fa-magnifying-glass"></i>
                      </span>

                      <input
                        value={query}
                        onChange={(e)=>{ setQuery(e.target.value); setSuggestOpen(true); }}
                        onFocus={()=> setSuggestOpen(true)}
                        onBlur={()=> setTimeout(()=> setSuggestOpen(false), 150)}
                        onKeyDown={onSearchKey}
                        className="w-full bg-transparent outline-none text-slate-900 dark:text-slate-100 placeholder:text-slate-500 dark:placeholder:text-slate-300"
                        placeholder={t.searchPlaceholder}
                      />

                      <button
                        className="px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700 active:scale-[0.98] font-extrabold"
                        onClick={goSearch}
                        type="button"
                      >
                        OK
                      </button>
                    </div>

                    {/* Suggestions */}
                    {suggestOpen && suggestions.length > 0 && (
                      <div className="absolute z-40 mt-2 w-full rounded-2xl border border-slate-200 dark:border-slate-800 bg-white/95 dark:bg-slate-950/90 backdrop-blur shadow-soft overflow-hidden">
                        {suggestions.map((s, idx) => (
                          <button
                            key={idx}
                            onMouseDown={(e)=>e.preventDefault()}
                            onClick={()=>{ setQuery(s.label); goSearch(); }}
                            className="w-full text-left px-4 py-3 text-sm font-semibold text-slate-800 dark:text-slate-100 hover:bg-slate-100 dark:hover:bg-slate-900"
                            type="button"
                          >
                            <i className="fa-solid fa-bolt mr-2 text-blue-600"></i>{s.label}
                          </button>
                        ))}
                      </div>
                    )}
                  </div>
                </div>

                {/* Controls */}
                <div className="flex flex-wrap items-center gap-3 mt-2">
                  <button
                    className="inline-flex items-center gap-2 px-4 py-2 rounded-xl border border-white/30 bg-white/10 text-white hover:bg-white/20 backdrop-blur"
                    onClick={handleThemeToggle}
                    type="button"
                  >
                    <i className={theme === "dark" ? "fa-solid fa-moon" : "fa-solid fa-sun"}></i>
                    <span className="font-semibold">{theme === "dark" ? t.themeNight : t.themeDay}</span>
                  </button>

                  <div className="flex items-center gap-2 px-3 py-2 rounded-xl border border-white/30 bg-white/10 backdrop-blur">
                    <i className="fa-solid fa-language text-white"></i>
                    <div className="flex gap-2">
                      {LANGS.map(l => (
                        <button
                          key={l.code}
                          onClick={() => handleLangChange(l.code)}
                          className={cx(
                            "px-3 py-1 rounded-lg text-sm font-semibold hover:bg-white/20",
                            lang === l.code ? "bg-white/25 text-white" : "text-white/90"
                          )}
                          type="button"
                        >
                          {l.label}
                        </button>
                      ))}
                    </div>
                  </div>

                  <button
                    className="inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700 shadow-lg"
                    onClick={() => setChatOpen(true)}
                    type="button"
                  >
                    <i className="fa-solid fa-robot"></i>
                    <span className="font-extrabold">{t.aiBtn}</span>
                  </button>
                </div>
              </div>
            </div>
          </header>

          {/* NAVBAR */}
          <nav className="sticky top-0 z-50 border-b border-slate-200/70 dark:border-slate-800 bg-white/90 dark:bg-slate-950/70 backdrop-blur">
            <div className="max-w-6xl mx-auto px-4 sm:px-6 py-3 flex items-center justify-between">
              <div className="flex items-center gap-3">
                <img src="pon21.png" alt="Logo" className="h-10 w-10 rounded-xl object-cover shadow" />
                <div className="leading-tight">
                  <div className="text-lg md:text-xl font-extrabold text-slate-900 dark:text-white">{t.brand}</div>
                  <div className="text-xs text-slate-600 dark:text-slate-300">{t.quickTitle}</div>
                </div>
              </div>

              <ul className="hidden md:flex items-center gap-6">
                {nav.map(item => (
                  <li key={item.href}>
                    <a href={item.href} className="text-sm font-semibold text-slate-800 hover:text-blue-700 dark:text-slate-100 dark:hover:text-blue-300">
                      {item.label}
                    </a>
                  </li>
                ))}
              </ul>

              <div className="flex items-center gap-3">
                <button
                  onClick={() => setChatOpen(true)}
                  className="hidden md:inline-flex items-center gap-2 px-3 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700"
                  type="button"
                >
                  <i className="fa-solid fa-robot"></i>{t.aiBtn}
                </button>

                <button
                  onClick={handleThemeToggle}
                  className="hidden sm:inline-flex items-center gap-2 px-3 py-2 rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 hover:shadow"
                  type="button"
                >
                  <i className={cx("fa-solid", theme === "dark" ? "fa-moon" : "fa-sun")}></i>
                  <span className="text-sm font-semibold">{theme === "dark" ? t.themeNight : t.themeDay}</span>
                </button>

                <div className="hidden sm:flex items-center gap-2">
                  {LANGS.map(l => (
                    <button
                      key={l.code}
                      onClick={() => handleLangChange(l.code)}
                      className={cx(
                        "px-3 py-2 rounded-xl text-sm font-bold border",
                        lang === l.code
                          ? "border-blue-600 bg-blue-600 text-white"
                          : "border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-100 hover:shadow"
                      )}
                      type="button"
                    >
                      {l.code.toUpperCase()}
                    </button>
                  ))}
                </div>

                <button
                  onClick={() => setMenuOpen(v => !v)}
                  className="md:hidden inline-flex items-center justify-center w-11 h-11 rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900"
                  type="button"
                >
                  <i className={cx("fa-solid", menuOpen ? "fa-xmark" : "fa-bars")}></i>
                </button>
              </div>
            </div>

            {/* Mobile menu */}
            <div className={cx("md:hidden", menuOpen ? "block" : "hidden")}>
              <div className="max-w-6xl mx-auto px-4 sm:px-6 pb-4">
                <div className="rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-4 shadow-sm">
                  <div className="grid gap-2">
                    {nav.map(item => (
                      <a
                        key={item.href}
                        href={item.href}
                        className="px-4 py-3 rounded-xl font-semibold text-slate-800 dark:text-slate-100 hover:bg-slate-100 dark:hover:bg-slate-800"
                      >
                        {item.label}
                      </a>
                    ))}
                    <button
                      onClick={() => setChatOpen(true)}
                      className="px-4 py-3 rounded-xl font-extrabold bg-blue-600 text-white hover:bg-blue-700"
                      type="button"
                    >
                      <i className="fa-solid fa-robot mr-2"></i>{t.aiBtn}
                    </button>
                  </div>

                  <div className="mt-4 flex flex-wrap items-center gap-2">
                    <button
                      onClick={handleThemeToggle}
                      className="px-4 py-2 rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 hover:shadow font-semibold"
                      type="button"
                    >
                      <i className={cx("fa-solid mr-2", theme === "dark" ? "fa-moon" : "fa-sun")}></i>
                      {theme === "dark" ? t.themeNight : t.themeDay}
                    </button>

                    {LANGS.map(l => (
                      <button
                        key={l.code}
                        onClick={() => handleLangChange(l.code)}
                        className={cx(
                          "px-4 py-2 rounded-xl border font-semibold",
                          lang === l.code
                            ? "border-blue-600 bg-blue-600 text-white"
                            : "border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 text-slate-800 dark:text-slate-100"
                        )}
                        type="button"
                      >
                        {l.label}
                      </button>
                    ))}
                  </div>
                </div>
              </div>
            </div>
          </nav>

          {/* MAIN */}
          <main className="max-w-6xl mx-auto px-4 sm:px-6 py-10 md:py-12">
            {/* ‚úÖ ‚ÄúBo‚Äòlimlar‚Äù ko‚Äòrinmay qolmasin: doim kontrast */}
            <h2 className="text-[clamp(1.35rem,3.2vw,2.05rem)] font-extrabold text-slate-900 dark:text-white mb-8">
              {t.quickTitle}
            </h2>

            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
              <a
                href="izlew.html"
                className="group rounded-3xl p-6 border shadow-sm bg-white dark:bg-slate-900 border-slate-200 dark:border-slate-800 hover:shadow-xl hover:-translate-y-1 active:scale-[0.99]"
              >
                <div className="flex items-start justify-between gap-4">
                  <div>
                    <h3 className="text-xl font-extrabold text-blue-700 dark:text-blue-300">{t.cardDictTitle}</h3>
                    <p className="mt-2 text-slate-700 dark:text-slate-200 text-sm leading-relaxed">{t.cardDictDesc}</p>
                  </div>
                  <div className="w-12 h-12 rounded-2xl bg-blue-600/10 dark:bg-blue-500/15 flex items-center justify-center">
                    <i className="fa-solid fa-book text-blue-700 dark:text-blue-300"></i>
                  </div>
                </div>
                <div className="mt-5 inline-flex items-center gap-2 text-sm font-bold text-blue-700 dark:text-blue-300">
                  {t.cardOpen}<i className="fa-solid fa-arrow-right group-hover:translate-x-1"></i>
                </div>
              </a>

              <a
                href="qosiq.html"
                className="group rounded-3xl p-6 border shadow-sm bg-white dark:bg-slate-900 border-slate-200 dark:border-slate-800 hover:shadow-xl hover:-translate-y-1 active:scale-[0.99]"
              >
                <div className="flex items-start justify-between gap-4">
                  <div>
                    <h3 className="text-xl font-extrabold text-blue-700 dark:text-blue-300">{t.cardAudioTitle}</h3>
                    <p className="mt-2 text-slate-700 dark:text-slate-200 text-sm leading-relaxed">{t.cardAudioDesc}</p>
                  </div>
                  <div className="w-12 h-12 rounded-2xl bg-blue-600/10 dark:bg-blue-500/15 flex items-center justify-center">
                    <i className="fa-solid fa-volume-high text-blue-700 dark:text-blue-300"></i>
                  </div>
                </div>
                <div className="mt-5 inline-flex items-center gap-2 text-sm font-bold text-blue-700 dark:text-blue-300">
                  {t.cardOpen}<i className="fa-solid fa-arrow-right group-hover:translate-x-1"></i>
                </div>
              </a>
            </div>

            {/* SOCIAL */}
            <section className="mt-14">
              <div className="flex items-center justify-between gap-4 mb-5">
                {/* ‚úÖ ‚ÄúBiz bilan bog‚Äòlaning‚Äù oq fonda yo‚Äòqolmasin */}
                <h3 className="text-[clamp(1.1rem,2.6vw,1.35rem)] font-extrabold text-slate-900 dark:text-white">
                  {t.socialTitle}
                </h3>
                <div className="text-sm text-slate-600 dark:text-slate-300">
                  <i className="fa-solid fa-bolt mr-2"></i>Interaktiv havolalar
                </div>
              </div>

              <div className="grid grid-cols-2 sm:grid-cols-4 gap-4">
                {[
                  { href: "https://t.me/atabek_offical01", icon: "fa-telegram", label: "Telegram" },
                  { href: "https://instagram.com/atabekkoshkinbaev", icon: "fa-instagram", label: "Instagram" },
                  { href: "https://facebook.com/share/15FSXUZmzg/", icon: "fa-facebook", label: "Facebook" },
                  { href: "https://youtube.com/@karsu_news", icon: "fa-youtube", label: "YouTube" },
                ].map(s => (
                  <a
                    key={s.label}
                    href={s.href}
                    target="_blank"
                    rel="noreferrer"
                    className="rounded-3xl p-5 border bg-white dark:bg-slate-900 border-slate-200 dark:border-slate-800 hover:shadow-xl hover:-translate-y-1 active:scale-[0.99] flex flex-col items-center justify-center gap-2"
                  >
                    <div className="w-12 h-12 rounded-2xl bg-blue-600/10 dark:bg-blue-500/15 flex items-center justify-center">
                      <i className={cx("fa-brands", s.icon, "text-2xl text-blue-700 dark:text-blue-300")}></i>
                    </div>
                    <div className="font-extrabold text-slate-800 dark:text-slate-100">{s.label}</div>
                  </a>
                ))}
              </div>
            </section>
          </main>

          {/* FOOTER */}
          <footer className="border-t border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950">
            <div className="max-w-6xl mx-auto px-4 sm:px-6 py-12 grid grid-cols-1 md:grid-cols-3 gap-8">
              <div className="space-y-4">
                <h4 className="text-lg font-extrabold text-slate-900 dark:text-white">{t.aboutTitle}</h4>
                <p className="text-sm leading-relaxed text-slate-700 dark:text-slate-200">{t.aboutText}</p>
                <img src="t1.jfif" alt="Profile" className="w-40 h-40 object-cover rounded-full border-4 border-slate-200 dark:border-slate-800 shadow" />
              </div>

              <div className="space-y-4">
                <h4 className="text-lg font-extrabold text-slate-900 dark:text-white">{t.rememberTitle}</h4>
                <div className="space-y-2 text-sm text-slate-800 dark:text-slate-100">
                  <div className="p-4 rounded-2xl bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-800">{t.q1}</div>
                  <div className="p-4 rounded-2xl bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-800">{t.q2}</div>
                  <div className="p-4 rounded-2xl bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-800">{t.q3}</div>
                  <div className="font-bold text-slate-600 dark:text-slate-300">{t.author}</div>
                </div>
              </div>

              <div className="space-y-4">
                <h4 className="text-lg font-extrabold text-slate-900 dark:text-white">{t.contactTitle}</h4>

                <div className="rounded-3xl p-5 border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900">
                  <div className="text-sm font-bold text-slate-800 dark:text-slate-100">{t.founder}</div>
                  <div className="text-sm text-slate-700 dark:text-slate-200 mt-1">{t.founderName}</div>
                  <div className="mt-2 text-sm font-extrabold text-blue-700 dark:text-blue-300">+998 93 047 97 44</div>
                </div>

                <div className="rounded-3xl p-5 border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900">
                  <div className="text-sm font-bold text-slate-800 dark:text-slate-100">{t.tech}</div>
                  <div className="text-sm text-slate-700 dark:text-slate-200 mt-1">{t.techName}</div>
                  <div className="mt-2 text-sm font-extrabold text-blue-700 dark:text-blue-300">+998 99 131 76 11</div>
                </div>
              </div>
            </div>

            <div className="text-center text-xs text-slate-600 dark:text-slate-400 py-6 border-t border-slate-200 dark:border-slate-800">
              ¬© 2025 Qaraqalpaq_s√≥zlik. {t.rights}
            </div>
          </footer>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>
